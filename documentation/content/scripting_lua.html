<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Manual</title>
    </head>
    <body style="font-size:16pt;font-family:helvetica">

        <p><center><h3>LUA-скрипты</h3></center></p>

        <p>
        LUA - это скриптовый язык программирования, особенностью является реализация большого числа программных сущностей минимумом синтаксических средств,
        а также простая интеграция в программное обеспечение, написанное на языке С/С++. Язык предназначен для пользователей,
        не являющихся профессиональными программистами, вследствие чего большое внимание уделено простоте дизайна
        и лёгкости обучения.
        </p>

        <p>
        На начальных этапах разработки protodb было решено не идти путём Docklight в виде разработки
        собственного DSL, а воспользоваться уже существующим скриптовым языком. LUA для этих целей подходил лучше всего.
        </p>

        <p>
        Логика программы в качестве реакции на события, а именно старт сессии, отправка данных, приём данных и завершение сессии,
        будет вызывать через стек LUA строго определенные функции. Ниже представлен базовый шаблон скрипта:
        </p>

        <p><pre>
function start()
    log:print("Seance started")
end

function stop()
    log:print("Seance stoped")
end

function beforeTransmit(msg)
    -- В обработчике beforeTransmit можно поработать с данными до их отправки.
    -- Например, добавить к посылке контрольные суммы.
    -- Помните, начальный индекс в массиве LUA - 1, а не 0.
end

function afterReceive(msg)
    -- Обработчик afterReceive служит для обработки принятых данных.
end
        </pre></p>

        <p>
        log::print - это специальная функция, позволяющая пользователю выводить текст в лог программы.
        В дальнейшем планируется расширить набор стандартных функций, например функцией остановки сессии или расчётом crc.
        </p>

        <p>
        Также пользователю доступны некоторые стандартные библиотеки LUA, а именно base, math и string. Технически, добавление
        других библиотек не составляет труда, а текущий список ограничен по соображениям безопасности.
        </p>

        <p><center><h3>Генерация последовательностей с помощью LUA</h3></center></p>

        <p>
        Плагин даёт вам возможность генерировать последовательности с помощью скрипта. Для понимания принципа работы
        представим lua-функцию, в которую в качестве аргумента передаётся пустой контейнер:
        </p>

        <p><pre>
function compile(bytes)
    -- Ваш код
end
        </pre></p>

        <p>
        Bytes - пустой массив, который вам нужно наполнить данными. Вы можете использовать все возможности языка, даже использовать
        функции:
        </p>

        <p><center>
            <img src="images/sequence_lua.png" />
        </center></p>

        <p>
        Пока неизвестно, насколько это удобно, но такая возможность пользователю дана.
        </p>

        <ul>
            <li><a href="scripting.html">Скрипты</a></li>
        </ul>
    </body>
</html>
